roa4 table r4;
roa6 table r6;

protocol rpki {
  roa4 { table r4; };
  roa6 { table r6; };

  remote 10.10.10.25 port 3323;
  transport tcp;

  retry keep 90;
  refresh keep 900;
  expire keep 3600; # should probably be higher
}

function check_roa_invalid()
{
  if (roa_check(r4, net, bgp_path.last) = ROA_INVALID ||
      roa_check(r6, net, bgp_path.last) = ROA_INVALID) then {
        return true;
  }

  return false;
}
